'use strict';window.addEventListener('load',function(){var a=getSelector('.player'),b=getSelector('audio',a),c=getSelector('.play_list'),d=getSelector('.controll'),f=getSelector('.autoplay-btn',d),g=getSelector('.loop-btn',d),h=getSelector('.prev-btn',d),j=getSelector('.next-btn',d);fetch('./store.json').then(function(k){return k.json()}).then(function(k){SetPlayList(k,c),SetTrack(getSelector('audio',a),'store/'+k[0].original),ChangeTrack(getSelectorAll('li',c),c,SetTrack),Listener(b,'autoplay',f),Listener(b,'loop',g),NextPrev(h,'prev'),NextPrev(j,'next'),f.addEventListener('click',function(){g.classList.contains('active')?g.classList.remove('active'):null}),g.addEventListener('click',function(){b.hasAttribute('autoplay')?b.removeAttribute('autoplay'):null,f.classList.contains('active')?f.classList.remove('active'):null})}),b.addEventListener('ended',function(){if(b.hasAttribute('autoplay')&&!b.hasAttribute('loop')){var k=getSelector('.play_list'),l=getSelector('li.active',k),m=getSelectorAll('li',k),n=m[0];l.nextElementSibling?(l.nextElementSibling.classList.add('active'),GetTrack(l.nextElementSibling)):(n.classList.add('active'),GetTrack(n)),l.classList.remove('active')}})});var SetTrack=function(a,b){'undefined'==typeof a.childNodes[0]?null:a.children[0].remove();var c=document.createElement('source');c.src=b,c.type='audio/mpeg',a.appendChild(c),a.load()},SetPlayList=function(a,b){var c=document.createElement('ul');a.forEach(function(d,f){var g=document.createElement('li');0===f?g.className='active':null,g.innerHTML=d.track,g.setAttribute('original',d.original),c.appendChild(g)}),b.appendChild(c)},ChangeTrack=function(a,b,c){a.forEach(function(d){d.addEventListener('click',function(){getSelector('.active',b).classList.remove('active'),d.classList.add('active');var f=d.getAttribute('original');c(getSelector('audio',getSelector('.player')),'store/'+f)})})},Listener=function(a,b,c){c.addEventListener('click',function(d){var f=d.target;f.classList.toggle('active'),a.hasAttribute(b)?a.removeAttribute(b):a.setAttribute(b,''),a.hasAttribute(b)?a.play():a.pause()})},NextPrev=function(a,b){a.addEventListener('click',function(){var d=getSelector('.player'),f=getSelector('audio',d),g=getSelector('.play_list'),h=getSelector('li.active',g),j=getSelectorAll('li',g),k=j[0],l=j[j.length-1];'next'===b&&(h.nextElementSibling?(h.nextElementSibling.classList.add('active'),GetTrack(h.nextElementSibling)):(k.classList.add('active'),GetTrack(k))),'prev'===b&&(h.previousElementSibling?(h.previousElementSibling.classList.add('active'),GetTrack(h.previousElementSibling)):(l.classList.add('active'),GetTrack(l))),h.classList.remove('active'),f.pause(),setTimeout(function(){return f.play()},300)})},GetTrack=function(a){var b=getSelector('.player'),c=a.getAttribute('original');SetTrack(getSelector('audio',b),'store/'+c)};